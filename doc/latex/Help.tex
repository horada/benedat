\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{czech}
\usepackage{listings}
\usepackage[top=2cm, bottom=3cm]{geometry}

\lstnewenvironment{kodConf}
    {}
    {}

%\newcommand{\tl}[1]{\emph{#1}}
\newcommand{\tl}[1]{\frame{#1}}
\newcommand{\kl}[1]{\emph{#1}}

    \begin{document}
\author{Daniel Horák}
\title{Nápověda k~programu BeneDat}
\maketitle
\tableofcontents


\section{Úvod}
Program BeneDat je určen ke zjednodušení výpočtu ceny pro klienty za využité služby občanského
sdružení. V~současné verzi umožňuje zaznamenávat dny a~hodiny využívání odlehčovací služby a~s~tím
související dopravu klienta. Z~těchto hodnot dojde při generování sestavy k~výpočtu celkové ceny,
vygenerování pdf souboru se sestavou (zároveň sloužící jako příjmový pokladní doklad) a~xml souboru
který je možno použít k~exportu dat do účetního programu Pohoda.
\section{Práce s~programem BeneDat}
\subsection{Před prvním spuštěním}
Instalace programu je popsána na jiném místě, zde pouze zmíním některé věci které je dobré (spíše
nutné) nastavit v~konfiguračním souboru. Pokud jste ještě program BeneDat nespustili, konfigurační
soubor ještě pravděpodobně není vytvořen. Spusťte tedy program BeneDat a~hned jej zase můžete
ukončit. V~hlavním adresáři programu (tam kde se nachází například soubor benedat.py) by jste měli
nalézt soubor benedat.conf se zhruba takovýmto obsahem:
\begin{verbatim}
  kod_cinnosti="odl"
  ico="0000"
  pokladna="HP"
  kod_strediska="0011-vl.zd"
  kod_predkontace="6023-odleh"
  poznamka_k_exportu="Převod dat z~programu BeneDat"
  kontrola_duplicity="true"
  kod_cleneni_dph="nonSubsume"
  otevreny_soubor="None"
  aplikace="BeneDat"
\end{verbatim} 
Zde je potřeba pozměnit některé volby pro správné fungování exportu do programu
Pohoda.
\subparagraph{kod\_cinnosti} kód činnosti jaký bude přiřazen dokladu
\subparagraph{ico} ičo organizace (pokud není uvedeno správě, při exportu do Pohody dostaneme
chybové hlášení ve smyslu \emph{tato položka není určena pro tuto účetní jednotku}.
\subparagraph{pokladna} kód pokladny
\subparagraph{kod\_strediska} kód střediska
\subparagraph{kod\_predkontace} kód předkontace
\subparagraph{poznamka\_k\_exportu} poznámka uvedená u~exportu
%\subparagraph{kontrola\_duplicity}
\subparagraph{kod\_cleneni\_dph} kód členění dph
\subparagraph{otevreny\_soubor} naposledy otevřený soubor (není potřeba upravovat -- nastavuje se
automaticky)
\subparagraph{aplikace} hodnota který bude u~exportu do Pohody uvedena v~kolonce aplikace 

Editaci souboru můžeme provést libovolným jednoduchým textovým editorem (například PSPad, notepad
a~podobně).


\subsection{První spuštění}
\subsection{Vytvoření nové -- otevření stávající databáze}
Stiskem příslušného tlačítka \tl{Nový} nebo \tl{Otevřít} vytvoříme/otevřeme databázový soubor. Celá
databáze je uložena v~jednom souboru s~příponou db.
\subsection{Základní nastavení}
Při vytvoření nové databáze případně při změně některých údajů je potřeba provést nastavení
konkrétní databáze. Toto nastavení je dostupné po rozbalení položky \tl{Pokročilé} v~hlavním okně
programu a~stiskem příslušného tlačítka \tl{Nastavení}.
\subsubsection{Ceny: Hranice počtu hodin}
\subparagraph{Dolní hranice} Spodní hranice u~které se láme cena za hodinu.
\subparagraph{Horní hranice} Horní hranice u~které se podruhé láme cena za hodinu.
\subsubsection{Ceny: Cestovné}
Cestovné je vypočteno podle vzorce:
\[cena = nastupni\_sazba + podil\_klienta \cdot \left(\frac{k}{100} \cdot cena\_za\_litr \cdot
(tarifni\_delka)^{exp}\right),\]
kde \emph{nastupni\_sazba}, \emph{podil\_klienta}, \emph{k}, \emph{ceba\_za\_litr},
\emph{tarifni\_delka} a~\emph{exp} jsou proměnné zadané v~tomto formuláři nebo (v~případě
\emph{tarifni\_delka}) u~každého klienta zvlášť.
\subsubsection{Sestavy: Kód dokladu}
\subparagraph{Stálá část} Konstantní prefix kódu dokladu.
\subparagraph{Proměnná část (aktuální hodnota)} Aktuální číslo proměnné části dokladu (toto číslo
bude uvedeno na další vytvořené sestavě, a~bude zvětšeno o~1).
\subsubsection{Sestavy: Adresa}
\subparagraph{Adresa} Adresa uváděná (tučně) například v~levé části sestavy (příjmového pokladního
dokladu). Jednotlivé řádky adresy jsou odděleny znakem $|$ (svislá čára -- možno napsat například
stiskem klávesy levý Alt a~napsáním čísla 124 nebo stiskem kombinace AltGr (pravý Alt) a~písmene W)
\subparagraph{Doplňující informace} Doplňující informace uvedené pod adresou
v~levé části sestavy (jednotlivé řádky jsou opět odděleny znakem $|$). 

\subsection{Klienti}
Okno pro správu klientů otevřeme stiskem příslušného tlačítka (\tl{Klienti}). 
\subsubsection{Přidání nového klienta}
Při přidávání nového klienta vyplníme potřebné údaje do formuláře pod tabulkou a~stiskem tlačítka
\tl{Uložit} případně klávesou \kl{Enter}. Není-li formulář pro přidání klienta prázdný, vyčistíme
jej tlačítkem \tl{Nový}.

U~klienta využívajícího \emph{odlehčovací službu} musíme zaškrtnout příslušné políčko. Poté bude
zpřístupněno několik doplňujících editačních polí k~zadání ceny. Cena je rozdělena na čtyři položky:
paušální cena a~3 variabilní ceny pro hodinovou sazbu. Hranice počtu hodin do které se platí cena
\emph{do} případně \emph{mezi} se nastavuje globálně v~nastavení celého programu. Chceme-li
klientovi účtovat pouze za hodiny, zadáme paušální cenu 0 a~ostatní ceny podle potřeby, naopak má-li
být klientovy účtováno pouze paušálně, zadáme tuto cenu do výše zmíněné položky a~ostatní nastavíme
na~0.

\subsubsection{Editace klienta}
Editaci vybraného klienta započneme dvojklikem na příslušný řádek v tabulce klientů. Vybraný klient
se zobrazí ve spodním formuláři kde můžeme provádět editaci. Uložení změn provedeme tlačítkem
\tl{Uložit} případně klávesou \kl{Enter}.

\subsubsection{Vymazání klienta z databáze}
Pro vymazání určitého klienta jej musíme nejprve dvojklikem vybrat v horní tabulce (stejně jako při
editaci). Samotné smazání poté provedeme tlačítkem \tl{Smazat} a potvrzením varovného dialogu.

\subsection{Záznamy odlehčovací služby}
Záznamy odlehčovací služby jednotlivých klientů se přidávají a editují obdobně jako klienti v okně které se
nám zobrazí po stisku tlačítka \tl{Editace záznamů} v hlavním okně.

Při zadávání jednotlivých řádků záznamů je však možno využít určitých ulehčujících vlastností.
\subsubsection{Klient}
Jméno klienta je možno do patřičné položky vyplnit několika různými způsoby:
\begin{enumerate}
  \item Stiskem tlačítka \tl{Klient} (fungujícího zároveň jako popisek editačního pole) se zobrazí
    seznam všech klientů.
  \item Započetím psaní jména klienta (ve formátu \emph{Jméno Příjmení} nebo \emph{Příjmení Jméno})
    a následným vybráním ze seznamu šipkami a potvrzení klávesou \kl{Enter}.
  \item Necháme-li pole \emph{Klient} prázdné a přeskočíme-li na vyplnění data (například klávesou
    \kl{Tab}) dojde k vyplnění klienta z předchozího záznamu.
\end{enumerate}

\subsubsection{Datum}
K zadání data máme opět několik možností:
\begin{enumerate}
  \item K vložení data můžeme využít kalendáře který se nám zobrazí při stisku tlačítka \tl{Datum}
    (obdobně jako v případě klienta).
  \item Datum též můžeme zadávat několika různými formáty: \emph{DD.MM.RRRR}, \emph{DD.MM} nebo
    \emph{DD}. Při zadání ve zkráceném tvaru se rok případně měsíc doplní podle dříve zadaných
    záznamů.
  \item Pokud místo data zadáme \emph{+} nebo \emph{-}, při přeskočení na další editační pole se
    doplní datum +1 nebo -1 den oproti předchozímu.
\end{enumerate}

\subsubsection{Čas od a Čas do}
Zadávání těchto položek je opět umožněno několika způsoby (formáty) zadání.
\begin{enumerate}
  \item Vyplněním celého času. Hodiny a minuty mohou být od sebe odděleny dvojtečkou (:), čárkou
    (,), tečkou (.), případně nijak. Tedy můžeme napsat: \emph{12:30}, \emph{12,30}, \emph{12.30} ale
    i \emph{1230}.
  \item Pokud zadáme pouze hodiny, dojde k doplnění nula minut.
  \item Necháme-li některé políčko prázdné, vyplní se předchozí zadaný čas. Stejně tak pokud zadáme
    nesrozumitelný řetězec.
\end{enumerate}

\subsubsection{Dovoz a Odvoz}
Patřičné políčko můžeme aktivovat stiskem klávesy \kl{mezerník}.

\subsubsection{Uložení záznamu}
Uložení záznamu je umožněno klávesou \kl{Enter} případně stiskem příslušného tlačítka. Po uložení
záznamu jsme přesunuti na první položku záznamu (Klient), můžeme tedy plynule zadávat další položky.

Zadáme-li jiné datum (měsíc nebo rok) než je nastaveno ve filtru, nebo zadáme-li druhý záznam k jednomu
klientovi na jedno datum, budeme na tuto skutečnost upozorněni varovným hlášením.



\end{document}
